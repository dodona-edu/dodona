<% membership_status = user.membership_status_for(course) %>
<% case membership_status
when 'pending' %>
  <%= button_to update_membership_course_path(course),
                params: {user: user.id, status: 'student'},
                title: t('users.index.accept'),
                class: 'btn btn-sm btn-success' do %>
    <span class='glyphicon glyphicon-ok' aria-hidden='true'></span>
  <% end %>
  <%= button_to update_membership_course_path(course),
                params: {user: user.id, status: 'unsubscribed'},
                title: t('users.index.decline'),
                class: 'btn btn-sm btn-danger' do %>
    <span class='glyphicon glyphicon-remove' aria-hidden='true'></span>
  <% end %>
<% when 'student' %>
  <% if policy(course).update_course_admin_membership? %>
    <%= button_to update_membership_course_path(course),
                  params: {user: user.id, status: 'course_admin'},
                  title: t('users.index.promote'),
                  data: { confirm: t('general.are_you_sure') },
                  class: 'btn btn-sm btn-default' do %>
      <span class='glyphicon glyphicon-education' aria-hidden='true'></span>
    <% end %>
  <% end %>
  <%= button_to update_membership_course_path(course),
                params: {user: user.id, status: 'unsubscribed'},
                title: t('users.index.unsubscribe'),
                data: { confirm: t('general.are_you_sure') },
                class: 'btn btn-sm btn-default' do %>
    <span class='glyphicon glyphicon-log-out' aria-hidden='true'></span>
  <% end %>
<% when 'course_admin' %>
  <% if policy(course).update_course_admin_membership? %>
    <%= button_to update_membership_course_path(course),
                  params: {user: user.id, status: 'student'},
                  title: t('users.index.demote'),
                  data: { confirm: t('general.are_you_sure') },
                  class: 'btn btn-sm btn-default' do %>
      <span class='glyphicon glyphicon-education glyphicon-strikethrough' aria-hidden='true'></span>
    <% end %>
  <% end %>
<% when 'unsubscribed' %>
  <%= button_to update_membership_course_path(course),
                params: {user: user.id, status: 'student'},
                title: t('courses.show.subscribe'),
                data: { confirm: t('general.are_you_sure') },
                class: 'btn btn-sm btn-default' do %>
    <span class='glyphicon glyphicon-log-in' aria-hidden='true'></span>
  <% end %>
<% end %>
