<%= content_for :javascripts do %>
  <%= javascript_pack_tag 'course' %>
<% end %>

<div class="row">
  <div class="col-xs-12">
    <div class="card">
      <div class="card-title card-title-colored">
        <h2 class="card-title-text"><%= t '.title' %></h2>
      </div>
    </div>
    <div class="page-searchbar table-toolbar">
      <div class="table-toolbar-tools">
        <i class="material-icons">search</i>
        <form class="search" onsubmit="return false;">
          <input type="text" id="filter-query" placeholder="<%= t "layout.search.search" %>" name="filter" autocomplete="off">
          <div id="progress-filter" class="dodona-progress dodona-progress-indeterminate">
            <div class="progressbar bar bar1" style="width: 0%;"></div>
            <div class="bufferbar bar bar2" style="width: 100%;"></div>
            <div class="auxbar bar bar3" style="width: 0%;"></div>
          </div>
        </form>
      </div>
    </div>
    <% @grouped_courses.each do |year, courses| %>
      <div class="page-subtitle">
        <a class="anchor" id="<%= year.parameterize %>"></a>
        <h3><%= Course.format_year year %></h3>
        <div class="flex-spacer"></div>
        <div>
          <% if policy(Course).new? && @grouped_courses.keys.first == year %>
            <%= link_to new_course_path, title: t("courses.new.title"), class: "btn btn-primary btn-fab-extended" do %>
              <i class="material-icons icon">add</i><span class='text'><%= t("courses.new.title") %></span>
            <% end %>
          <% end %>
        </div>
      </div>
      <div class="row">
      <% courses.each do |course| %>
        <div class="col-xs-12 col-sm-6 col-lg-4">
          <%= render partial: "pages/course_card", locals: {course: course, show_membership: true, course_index: true} %>
        </div>
      <% end %>
      </div>
    <% end %>
  </div>
</div>

<script type="text/javascript">
  $(function () {
    dodona.initCourseIndex();
  });
</script>
