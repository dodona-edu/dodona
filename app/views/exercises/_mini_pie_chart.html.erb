<%
    def getCoordinatesForPercent(percent)
        x = Math.cos(2 * Math::PI * percent)
        y = Math.sin(2 * Math::PI * percent)
        [x, y];
    end

    users_total += 0.0001
    slices = [
        { percent: users_correct / users_total, color: '#4caf50' },
        { percent: (users_tried - users_correct) / users_total, color: '#f44336' },
        { percent: 1 - (users_tried / users_total), color: '#dddddd' }
    ]
    cumulativePercent = 0

    slices = slices.map do |slice|
        startX, startY = getCoordinatesForPercent(cumulativePercent)
        cumulativePercent += slice[:percent]
        endX, endY = getCoordinatesForPercent(cumulativePercent)
        largeArcFlag = slice[:percent] > 0.5 ? 1 : 0
        
        "<path fill='#{slice[:color]}' d='M #{startX} #{startY} A 1 1 0 #{largeArcFlag} 1 #{endX} #{endY} L 0 0'/>"
    end
%>

<svg viewBox="-1 -1 2 2" style="transform: rotate(-90deg)" height="18">
    <%=raw slices.join("") %>
</svg>