<table class="table exercise-table table-resource">
  <thead>
  <tr>
    <% if local_assigns.fetch(:show_buttons_for_present, false) %>
      <th class="col-xs-1"></th>
    <% end %>
    <th class="col-xs-1"></th>
    <th class="col-xs-5"><%= t "exercises.index.exercise" %></th>
    <th class="col-xs-2"><%= t "exercises.index.repository" %></th>
    <th class="col-xs-2"><%= t "exercises.index.path" %></th>
    <th class="col-xs-1 actions"></th>
  </tr>
  </thead>
  <tbody>
    <% exercises.each do |exercise| %>
    <tr>
      <% if local_assigns.fetch(:show_buttons_for_present, false) %>
        <td>
          <div class="drag-handle">
            <i class="material-icons md-18">reorder</i>
          </div>
        </td>
      <% end %>
      <td class="status-icon">
        <%= raw "<i class='material-icons md-18' title='#{t("exercises.index.private")}'>visibility_off</i>" if exercise.access_private? %>
        <%= raw "<i class='material-icons md-18' title='#{t("exercises.index.removed")}'>delete</i>" if exercise.removed? %>
        <%= raw "<i class='material-icons md-18' title='#{t("exercises.index.invalid")}'>error</i>" if exercise.not_valid? %>
      </td>
      <td>
        <span class="pull-left ellipsis-overflow" title="<%= exercise.name %>">
          <%= link_to exercise.name, exercise_path(exercise), target: "_blank" %>
        </span>
        <span class="pull-right">
          <%# We can't just use exercise.labels because a search by labels might restrict the loaded labels %>
          <% Label.includes(:exercises).where(exercises: { id: exercise.id }).each do |label| %>
            <span class="label label-default accent-<%= label.color %>"><%= label.name %></span>
          <% end %>
          <span class="label label-default accent-teal"><%= exercise.programming_language.name %></span>
        </span>
      </td>
      <td>
        <%= exercise.repository.name %>
      </td>
      <td>
        <span class="ellipsis-overflow" title="<%= exercise.path %>"><%= exercise.path %></span>
      </td>
      <td class="actions">
        <% if !series.exercises.include? exercise %>
          <a href="#" class="btn btn-icon add-exercise" title="<%= t "series.edit.add_exercise"%>" data-series_id="<%= series.id %>" data-exercise_id="<%= exercise.id %>" data-exercise_name="<%= exercise.name %>" data-confirm="<%= t('.course_added_to_usable') unless exercise.usable_by? @series.course %>">
            <i class="material-icons md-18">add</i>
          </a>
        <% elsif local_assigns.fetch(:show_buttons_for_present, false)  %>
          <a href="#" class="btn btn-icon remove-exercise" title="<%= t "series.edit.remove_exercise"%>" data-series_id="<%= series.id %>" data-exercise_id="<%= exercise.id %>" data-exercise_name="<%= exercise.name %>">
            <i class="material-icons md-18">delete</i>
          </a>
        <% end %>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>
<% if local_assigns.fetch(:paginate, true) %>
  <center><%= page_navigation_links exercises, true, "exercises", {series_id: series.id}, "available" %></center>
<% end %>
