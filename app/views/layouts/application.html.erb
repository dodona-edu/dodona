<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Language" content="<%= I18n.locale.to_s %>">
    <meta name="description" content="<%= t "layout.head.description" %>">
    <meta name="author" content="<%= t "layout.footer.ugent" %>">
    <meta name="application-name" content="Dodona">
    <meta name="theme-color" content="#2196F3">
    <meta name="msapplication-TileColor" content="#2196F3" />
    <meta name="msapplication-TileImage" content="/icon.png" />
    <link rel="apple-touch-icon-precomposed" href="/icon.png" />
    <link rel="shortcut icon" sizes="192x192" href="/icon.png">
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="manifest" href="/manifest.json">
    <title>Dodona<%= " - #{@title}" if @title %></title>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,400italic,300,500,700' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <%= stylesheet_link_tag    'application', media: 'all' %>
    <%= javascript_pack_tag 'application' %>
    <%= javascript_include_tag 'application' %>
    <%= yield :javascripts %>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76309350-1', 'auto');
      ga('send', 'pageview');
    </script>
    <%= csrf_meta_tags %>
  </head>
  <body>
    <div id="page-wrapper" class="<%= 'with-drawer' if current_user %>">
      <%= render 'layouts/navbar' %>
      <% if user_signed_in? %>
        <%= render 'layouts/drawer' %>
      <% end %>
      <div id="main-container" class="container main">
        <div class="page-messages hidden-print">
          <% flash.each do |key, value| %>
            <% unless value.nil? %>
              <%= content_tag(:div, raw("<strong>#{t("layout.messages.info")}:</strong> ")+value, :class => "alert alert-info") if key == "notice" %>
              <%= content_tag(:div, raw("<strong>#{t("layout.messages.danger")}!</strong> ")+value, :class => "alert alert-danger") if key == "error" %>
              <%= content_tag(:div, raw("<strong>#{t("layout.messages.warning")}!</strong> ")+value, :class => "alert alert-warning") if key == "alert" %>
              <%= content_tag(:div, raw("<strong>#{t("layout.messages.success")}!</strong> ")+value, :class => "alert alert-success") if key == "success" %>
            <% end %>
          <% end %>
          <% if user_signed_in? %>
            <div class='alert alert-warning hidden' id="time-zone-warning">
              <strong><%= t("layout.messages.warning") %></strong> <%= t("layout.messages.time_zone_html", time_zone: current_user.time_zone, profile_edit: edit_user_path(current_user)) %>
            </div>
          <% end %>
          <% if user_signed_in? && current_user != true_user %>
            <div class='alert alert-info'>
              <%= t("layout.impersonate.impersonating_user")%>
              <%= link_to(current_user.full_name, current_user) %>!
              <%= link_to(t("layout.impersonate.switch_back"), stop_impersonating_users_path) + " " +  t("layout.impersonate.your_account")%>
            </div>
          <% end %>
          <% if user_signed_in? && current_user.username.blank? %>
            <div class='alert alert-warning'>
              <strong><%= t("layout.messages.warning") %></strong> <%= t("layout.messages.no_username") %>
            </div>
          <% end %>
        </div>
        <%= yield %>
      </div>
      <div class="notifications"></div>
      <%= render 'layouts/footer' %>
    </div>
    <script>
      I18n = I18n || {};
      I18n.locale = "<%= I18n.locale %>";
      dodona.checkTimeZone(<%= @time_zone_offset %>);
    </script>
  </body>
</html>
