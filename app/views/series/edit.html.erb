<div class="row">
  <div class="col-sm-10 col-sm-offset-1 col-xs-12">
    <div class="card">
      <div class="card-title card-title-colored">
        <h2 class="card-title-text"><%= @series.name %></h2>
        <div class="card-title-fab">
          <%= render 'fab_button', form: "edit_series_#{@series.id}", icon: 'ok' %>
        </div>
      </div>
      <div class="card-supporting-text row">
        <div class="col-xs-12 col-sm-8">
          <%= render 'form', series: @series %>
        </div>
      </div>
      <div class="card-supporting-text card-border">
        <h4><%= t '.indianio-support' %></h4>
        <div class="col-xs-12 col-sm-8">
          <div class="form-horizontal">
            <div class="field form-group">
              <%= label_tag :indianio_token, 'Token', class: 'col-sm-4 control-label' %>
              <div class="col-sm-8">
                <div class="input-group">
                  <%= text_field_tag :indianio_token, @series.indianio_token, readonly: true, placeholder: t('.indianio-placeholder'), class: 'form-control' %>
                  <span class="input-group-btn">
                    <% if @series.indianio_token %>
                      <button class="btn btn-default">
                        <span class='glyphicon glyphicon-copy'></span>
                      </button>
                      <%= link_to indianio_token_series_path(@series), method: :delete, data: {confirm: t('general.are_you_sure') }, class: 'btn btn-default' do %>
                        <span class="glyphicon glyphicon-trash"></span>
                      <% end %>
                    <% else %>
                      <%= link_to t('.indianio-generate'), indianio_token_series_path(@series), method: :post, class: 'btn btn-default' %>
                    <% end %>
                  </span>
                </div>
              </div>
              <span class="help-block col-sm-offset-4 col-sm-8">
                <%= t '.indianio-help' %>
              </span>
            </div>
          </div>
        </div>
      </div>
      <% if policy(@series).modify_exercises? %>
        <div class="card-supporting-text card-border row">
          <div class="col-xs-12 col-sm-6 col-sm-push-6">
            <h4><%= t ".exercises_in_series" %></h4>
            <div class="row series-exercise-list">
              <% @series.exercises.each do |exercise| %>
                <div class="col-xs-12 row exercise">
                  <div class='col-xs-1 drag-handle'>
                    <span class='glyphicon glyphicon-align-justify'></span>
                  </div>
                  <div class='col-xs-9'><%= link_to exercise.name, exercise, target: "_blank" %></div>
                  <div class='actions col-xs-2'>
                    <a href="#" class="btn btn-icon remove-exercise" title="<%= t "series.edit.remove_exercise" %>" data-exercise_id="<%= exercise.id %>" data-series_id="<%= @series.id %>" data-exercise_name="<%= exercise.name %>">
                      <span class='glyphicon glyphicon-trash'></span>
                    </a>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
          <div class="col-xs-12 col-sm-6 col-sm-pull-6">
            <h4><%= t ".add_exercises" %></h4>
            <%= render partial: 'layouts/searchbar', locals: { baseUrl: exercises_path(:series_id => @series.id), eager: true }  %>
            <div id="exercises-table-wrapper">
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(function () {
    init_series_edit();
  });
</script>
