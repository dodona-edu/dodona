<% content_for :javascripts do %>
  <%= javascript_pack_tag 'punchcard' %>
<% end %>
<div class="row">
  <div class="col-sm-10 col-sm-offset-1 col-xs-12">
    <div class="card">
      <div class="card-title card-title-colored">
        <h2 class="card-title-text"><%= @user.full_name %></h2>
        <% if policy(@user).edit? %>
          <div class="card-title-fab">
            <%= render 'fab_link', url: edit_user_path(@user), icon: 'edit' %>
          </div>
        <% end %>
      </div>
      <div class="card-supporting-text">
        <% unless @user.token.blank? %>
          <div class="card">
            <div class="card-title card-title-colored">
              <h2 class="card-title-text"><%= t ".sign_in" %></h2>
            </div>
            <div class="card-supporting-text">
              <p><%= t ".token_sign_in" %></p>
              <p><%= token_sign_in_user_url(@user, @user.token) %></p>
            </div>
          </div>
        <% end %>
        <p>
          <% if policy(@user).impersonate? %>
            <%= link_to impersonate_user_path(@user), class: "btn with-text btn-default" do %>
              <i class="material-icons md-18">person</i> <%= t("layout.impersonate.impersonate") %>
            <% end %>
          <% end %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("first_name") %>:</strong> <%= @user.first_name %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("last_name") %>:</strong> <%= @user.last_name %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("username") %>:</strong> <%= @user.username %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("ugent_id") %>:</strong> <%= @user.ugent_id %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("email") %>:</strong> <%= @user.email %>
        </p>
        <p>
          <strong><%= User.human_attribute_name("time_zone") %>:</strong> <%= @user.time_zone %>
        </p>
        <% if current_user.admin? %>
          <p>
            <strong><%= User.human_attribute_name("permission") %>:</strong> <%= @user.permission %>
          </p>
        <% end %>
        <p>
          <strong><%= t ".courses" %>:</strong>
          <% if @user.subscribed_courses.empty? %>
            <%= t ".no_courses" %>
          <% else %>
          <ul>
            <% @user.subscribed_courses.each do |course| %>
              <li><%= link_to course.name, course %></li>
            <% end %>
          </ul>
        <% end %>
        </p>
        <p>
          <strong><%= t ".correctly_solved" %>:</strong> <%= @user.correct_exercises %>
        </p>
        <p>
          <strong><%= t ".unfinished" %>:</strong> <%= @user.unfinished_exercises %>
        </p>
        <p>
          <strong><%= t ".solutions" %>:</strong> <%= link_to @user.submissions.count, user_submissions_path(@user) %>
        </p>
      </div>
    </div>
    <%= render partial: 'visualizations/punchcard' %>
  </div>
</div>
<script type="text/javascript">
    $(function () {
        dodona.initPunchcard('<%= raw punchcard_path(:user_id => @user.id) %>');
    });
</script>

